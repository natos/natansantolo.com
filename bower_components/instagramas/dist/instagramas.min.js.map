{"version":3,"sources":["?","../src/instagramas.js","../src/jsonp.js"],"names":["exports","global","$w","$d","isBoolean","b","valueOf","API_PREFIX","data","data-show-tags","attributeName","defaultValue","data-show-tags-count","data-show-likes","data-render-type","data-count","template","tag","loader","HTMLElement","_","c","o","i","length","createElement","new","e","cloneNode","Instagramas","element","$this","this","access_token","getAttribute","undefined","removeAttribute","children","childrenLoaded","member","source","count","className","innerHTML","appendChild","setAttribute","get","create","prototype","childLoaded","ready","removeChild","callback","success","response","call","jsonp","push","Instagrama","$data","$parent","parent","render","figure","tagscaption","likescaption","a","t","img","tags","type","target","href","link","alt","caption","text","src","images","renderType","url","onload","apply","arguments","showLikes","likes","showTags","showTagsCount","replace","instagramas","querySelectorAll","namespace","_instagramas_namespace","collection","addEventListener","window","document","serialize","obj","prefix","str","p","hasOwnProperty","k","v","encodeURIComponent","join","load","script","done","async","onreadystatechange","readyState","parentNode","getElementsByTagName","params","query","fname","Date"],"mappings":"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","file":"instagramas.min.js","sourcesContent":[null,"/*!\n * Instagrams.js\n *\n * Renders latest instagramas\n * @require jsonp.js\n */\n\n(function($w, $d) {\n\n    'use strict';\n\n    var API_PREFIX = 'https://api.instagram.com/v1/users/self/media/recent/?';\n\n    /**\n     * Default properties and values\n     * @private @const data\n     */\n    var data = {\n        'data-show-tags': {\n            attributeName: 'showTags',\n            defaultValue: false\n        },\n        'data-show-tags-count': {\n            attributeName: 'showTagsCount',\n            defaultValue: 1\n        },\n        'data-show-likes': {\n            attributeName: 'showLikes',\n            defaultValue: false\n        },\n        'data-render-type': {\n            attributeName: 'renderType',\n            defaultValue: 'thumbnail'\n        },\n        'data-count': {\n            attributeName: 'count',\n            defaultValue: 5\n        }\n    };\n\n    /**\n     * Templates map\n     * @private @const template\n     */\n    var template = {\n        'tag': '<span class=\"instagrama-tag\">{{tag}}</span>',\n        'loader': '<div class=\"spinner\"><div class=\"dot1\"></div><div class=\"dot2\"></div></div>'\n    };\n\n    /**\n     * DOM elements cache\n     * @private @const elements\n     */\n    var HTMLElement = {\n        _: (function(c) {\n            var o = {};\n            for (var i = 0; i < c.length; i += 1) {\n                o[c[i]] = $d.createElement(c[i]);\n            }\n            return o;\n        }(['div', 'figure', 'figcaption', 'img', 'a'])),\n        new: function(e) {\n            return HTMLElement._[e].cloneNode(false);\n        }\n    };\n\n    /**\n     * Returns if a variable is a boolean\n     * @private @function isBoolean\n     * @return {boolean} true if the passed variable is boolean\n     */\n    function isBoolean(b) {\n        return typeof b === 'boolean' || (typeof b === 'object' && typeof b.valueOf() === 'boolean');\n    }\n\n    /**\n     * Creates a gallery of Instagramas using a valid Instagram access token\n     * @private @class Instagramas\n     * @param {HTMLElement} element - Placeholder element for Instagramas gallery\n     */\n    var Instagramas = function(element) {\n\n        var $this = this;\n        var access_token = element.getAttribute('data-access-token');\n\n        if (access_token === undefined || access_token === null) {\n            throw (\"Instagramas missing access token: Instagramas needs access token to fetch information from instragram.\");\n        } else {\n            element.removeAttribute('data-access-token');\n        }\n\n        $this.element = element;\n        $this.children = [];\n        $this.childrenLoaded = 1;\n\n        for (var member in data) {\n            $this[data[member].attributeName] = (isBoolean(data[member].defaultValue)) ?\n            element.getAttribute(member) === \"true\" || data[member].defaultValue :\n                element.getAttribute(member) || data[member].defaultValue;\n        }\n\n        var source = API_PREFIX + 'count=' + $this.count + '&amp;' + 'access_token=' + access_token;\n\n        $this.loader = HTMLElement.new('div');\n        // $this.loader = $d.createElement('div');\n        $this.loader.className = 'loader';\n        $this.loader.innerHTML = template.loader;\n        $this.element.appendChild($this.loader);\n        $this.element.setAttribute('data-state', 'initiated');\n\n        $this.get(source, $this.create);\n    };\n\n    /**\n     * @public @method childLoaded\n     * @return this\n     */\n    Instagramas.prototype.childLoaded = function() {\n        var $this = this;\n        if ($this.children.length === $this.childrenLoaded) {\n            $this.childrenLoaded = null;\n            delete $this.childrenLoaded;\n            return $this.ready();\n        }\n        $this.childrenLoaded += 1;\n        return $this;\n    };\n    /**\n     * @public @method ready\n     * @return this\n     */\n    Instagramas.prototype.ready = function() {\n        var $this = this;\n        $this.element.setAttribute('data-state', 'ready');\n        $this.element.removeChild($this.loader);\n        return $this;\n    };\n\n    /**\n     * Gets from the provided source though JSONP and executes the callback\n     * @public @method get\n     * @param {string} source - URL of the source of content\n     * @return {object} jsonp - JSON-P loader\n     */\n    Instagramas.prototype.get = function(source, callback) {\n        var $this = this;\n        $this.element.setAttribute('data-state', 'get:in-progress');\n        // TODO: Handle error cases\n        function success(response) {\n            $this.element.setAttribute('data-state', 'get:success');\n            callback.call($this, response);\n        }\n        return jsonp.get(source, success);\n    };\n\n    /**\n     * Creates the gallery content from the provided Instagram's API response.\n     * @public @method create\n     * @param {object} response - Instagram's API response object.\n     */\n    Instagramas.prototype.create = function(response) {\n        var $this = this;\n        var i;\n        if (!response.data) {\n            return;\n        }\n        for (i = 0; i < response.data.length; i += 1) {\n            $this.children.push(new Instagrama(response.data[i], $this));\n        }\n        $this.element.setAttribute('data-state', 'created');\n    };\n\n    /**\n     * Creates a single Instagram picture\n     * @private @class Instagrama\n     * @param {object} $data - Object that describe a picture from Instragram's API Response.\n     * @return {object} $this - Instagrama instance\n     */\n    var Instagrama = function($data, $parent) {\n\n        if (!$data) {\n            return this;\n        }\n\n        var $this = this;\n        $this.parent = $parent;\n        $this.data = $data;\n        $this.render();\n\n        return $this;\n    };\n\n    /**\n     * Renders the content of the picture\n     * @public @method render\n     * @return {object} $this - Instagrama instance\n     */\n    Instagrama.prototype.render = function() {\n\n        var $this = this,\n            figure,\n            tagscaption,\n            likescaption,\n            a, i, t, img,\n            tags = '',\n            likes = 0;\n\n        // figure = $d.createElement('figure');\n        figure = HTMLElement.new('figure');\n        figure.className = 'instagrama-' + $this.data.type;\n\n        // a = $d.createElement('a');\n        a = HTMLElement.new('a');\n        a.target = '_blank';\n        a.className = 'instagrama';\n        a.href = $this.data.link;\n        figure.appendChild(a);\n\n        // img = $d.createElement('img');\n        img = HTMLElement.new('img');\n        img.alt = $this.data.caption.text;\n        img.src = $this.data.images[$this.parent.renderType].url;\n        img.onload = function() {\n            $this.parent.childLoaded.apply($this.parent, arguments);\n        };\n        a.appendChild(img);\n\n        // likes\n        if ($this.parent.showLikes) {\n            // likescaption = $d.createElement('figcaption');\n            likescaption = HTMLElement.new('figcaption');\n            likescaption.className = 'instagrama-likes';\n            likescaption.innerHTML = $this.data.likes.count;\n            a.appendChild(likescaption);\n        }\n\n        // collect tags\n        if ($this.parent.showTags) {\n            t = $this.parent.showTagsCount || $this.data.tags.length;\n            for (i = 0; i < t; i += 1) {\n                if (!$this.data.tags[i]) {\n                    continue;\n                }\n                tags += template.tag.replace('{{tag}}', $this.data.tags[i]);\n            }\n\n            // tagscaption = $d.createElement('figcaption');\n            tagscaption = HTMLElement.new('figcaption');\n            tagscaption.className = 'instagrama-tags';\n            tagscaption.innerHTML = tags;\n            a.appendChild(tagscaption);\n        }\n\n        $this.parent.element.appendChild(figure);\n\n        return $this;\n    };\n\n    /*\n    * @private\n    * Will find all instances of instagramas in the document\n    */\n    var instagramas = $d.querySelectorAll('.instagramas');\n    if (instagramas === undefined || instagramas === null) {\n        return;\n    }\n\n    /**\n    * @private\n    * Instagramas namespace can be predefined by setting a string in the global\n    * variable `_instagramas_namespace` with the name of your choosing, otherwise\n    * will automatically use the defautl value `_Instagramas`.\n    */\n    var namespace = $w._instagramas_namespace || '_Instagramas';\n\n    /**\n    * @public\n    * Define the namespace to store instagramas instances.\n    */\n    $w[namespace] = {\n        collection: []\n    };\n\n    /*\n    * Start, when DOM ready, create a Instagramas instance for each match.\n    */\n    $d.addEventListener(\"DOMContentLoaded\", function start() {\n        for (var i = 0; i < instagramas.length; i += 1) {\n            $w[namespace].collection.push(new Instagramas(instagramas[i]));\n        }\n    });\n\n}(window, document));","/*!\n * jsonp.js\n */\n\n(function(window, document) {\n\n    'use strict';\n\n    var count = 0;\n\n    function serialize(obj, prefix) {\n\n        var str = [];\n        for(var p in obj) {\n            if (obj.hasOwnProperty(p)) {\n                var k = prefix ? prefix + \"[\" + p + \"]\" : p, v = obj[p];\n                str.push(typeof v == \"object\" ?\n                    serialize(v, k) :\n                    encodeURIComponent(k) + \"=\" + encodeURIComponent(v));\n            }\n        }\n        return str.join(\"&\");\n    }\n\n    function load(url) {\n\n        var script = document.createElement('script'),\n        done = 0;\n        script.src = url;\n        script.async = true;\n        script.onload = script.onreadystatechange = function() {\n            if (!done && (!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")) {\n                done = true;\n                script.onload = script.onreadystatechange = null;\n                if ( script && script.parentNode ) {\n                    script.parentNode.removeChild( script );\n                }\n            }\n        };\n        document.getElementsByTagName('head')[0].appendChild(script);\n    }\n\n    function get(url, params, callback) {\n        var query = '';\n        if (typeof params === 'function' && typeof callback === 'undefined') {\n            callback = params;\n        } else {\n            query = serialize(params);\n        }\n        count += 1;\n        var fname = 'phealer' + '_' + new Date().valueOf() + count;\n        window[fname] = function (response) {\n            callback && callback(response);\n            try {\n                delete window[fname];\n            } catch (e) {}\n            window[fname] = null;\n        }\n        load(url + query + \"&amp;callback=\" + fname);\n    }\n\n    window.jsonp = {\n        get: get\n    };\n\n}(window, document));"]}